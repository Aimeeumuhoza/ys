# FROM node:15-alpine3.12
FROM node:16-alpine3.15

# Configure the main working directory inside the docker image. 
# This is the base directory used in any further RUN, COPY, and ENTRYPOINT 
# commands.
RUN mkdir -p /app
WORKDIR /app

# Installing dependencies
COPY package.json .

RUN yarn install

# Copying source files
COPY . .

ENV NEXT_PUBLIC_HOSTNAME=${NEXT_DEV_PUBLIC_HOSTNAME}
ENV NEXT_PUBLIC_API_HOST=${NEXT_DEV_PUBLIC_API_HOST}
ENV NEXT_PUBLIC_NODE_ENV=${NEXT_DEV_PUBLIC_NODE_ENV}
ENV NEXT_PUBLIC_API_ENDPOINT=${NEXT_DEV_PUBLIC_API_ENDPOINT}
ENV NEXT_PUBLIC_FIREBASE_API_KEY=${NEXT_PUBLIC_FIREBASE_API_KEY}
ENV NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=${NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN}
ENV NEXT_PUBLIC_FIREBASE_DB_URL=${NEXT_PUBLIC_FIREBASE_DB_URL}
ENV NEXT_PUBLIC_FIREBASE_PROJECT_ID=${NEXT_PUBLIC_FIREBASE_PROJECT_ID}
ENV NEXT_PUBLIC_FIREBASE_PROJECT_BUCKET=${NEXT_PUBLIC_FIREBASE_PROJECT_BUCKET}
ENV NEXT_PUBLIC_FIREBASE_MSG_SENDER_ID=${NEXT_PUBLIC_FIREBASE_MSG_SENDER_ID}
ENV NEXT_PUBLIC_FIREBASE_APP_ID=${NEXT_PUBLIC_FIREBASE_APP_ID}
ENV NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=${NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID}
ENV NEXT_PUBLIC_GEO_LOCATION_API=${NEXT_PUBLIC_GEO_LOCATION_API}
ENV NEXT_PUBLIC_GOOGLE_MAP_API_KEY=${NEXT_PUBLIC_GOOGLE_MAP_API_KEY}
ENV NEXT_PUBLIC_CLOUDINARY_API_UPLOAD_URL=${NEXT_PUBLIC_CLOUDINARY_API_UPLOAD_URL} 
ENV NEXT_PUBLIC_CLOUDINARY_API_UPLOAD_PRESET=${NEXT_PUBLIC_CLOUDINARY_API_UPLOAD_PRESET}

EXPOSE 3000

# Running the app
CMD ["yarn", "dev"]